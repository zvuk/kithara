[target.wasm32-unknown-unknown]
runner = "wasm-server-runner"
rustflags = [
    "-C", "target-feature=+atomics,+bulk-memory,+mutable-globals",
    "-C", "link-arg=--shared-memory",
    "-C", "link-arg=--import-memory",
    "-C", "link-arg=--max-memory=1610612736",
    "-C", "link-arg=--export=__wasm_init_tls",
    "-C", "link-arg=--export=__tls_size",
    "-C", "link-arg=--export=__tls_align",
    "-C", "link-arg=--export=__tls_base",
]

# Only takes effect with nightly cargo (ignored by stable).
# Needed to rebuild std with shared-memory support for wasm32 + atomics.
[unstable]
build-std = ["std", "panic_abort"]
